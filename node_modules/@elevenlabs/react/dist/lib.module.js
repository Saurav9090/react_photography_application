import{useRef as n,useState as e,useEffect as o}from"react";import{Conversation as r}from"@elevenlabs/client";export{postOverallFeedback}from"@elevenlabs/client";function t(){return t=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)({}).hasOwnProperty.call(o,r)&&(n[r]=o[r])}return n},t.apply(null,arguments)}var l=["micMuted","volume","serverLocation"];function u(n){switch(void 0===n&&(n="us"),n){case"eu-residency":case"in-residency":case"us":case"global":return n;default:return console.warn("[ConversationalAI] Invalid server-location: "+n+'. Defaulting to "us"'),"us"}}function i(n){return{us:"wss://api.elevenlabs.io","eu-residency":"wss://api.eu.residency.elevenlabs.io","in-residency":"wss://api.in.residency.elevenlabs.io",global:"wss://api.elevenlabs.io"}[n]}function c(n){return{us:"wss://livekit.rtc.elevenlabs.io","eu-residency":"wss://livekit.rtc.eu.residency.elevenlabs.io","in-residency":"wss://livekit.rtc.in.residency.elevenlabs.io",global:"wss://livekit.rtc.elevenlabs.io"}[n]}function a(a){void 0===a&&(a={});var s=a.micMuted,v=a.volume,d=a.serverLocation,f=function(n,e){if(null==n)return{};var o={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(-1!==e.indexOf(r))continue;o[r]=n[r]}return o}(a,l),g=n(null),h=n(null),p=e("disconnected"),C=p[0],m=p[1],b=e(!1),y=b[0],M=b[1],P=e("listening"),S=P[0],I=P[1],w=n(s),D=n(v);return w.current=s,D.current=v,o(function(){var n;void 0!==s&&(null==g||null==(n=g.current)||n.setMicMuted(s))},[s]),o(function(){var n;void 0!==v&&(null==g||null==(n=g.current)||n.setVolume({volume:v}))},[v]),o(function(){return function(){var n;null==(n=g.current)||n.endSession()}},[]),{startSession:function(n){try{var e,o,l=function(e){return o?e:function(e,o){try{var l=(O=i(A=u((null==n?void 0:n.serverLocation)||d)),F=c(A),h.current=r.startSession(t({},null!=f?f:{},null!=n?n:{},{origin:O,livekitUrl:F,overrides:t({},null!=(a=null==f?void 0:f.overrides)?a:{},null!=(s=null==n?void 0:n.overrides)?s:{},{client:t({},null!=(v=null==f||null==(p=f.overrides)?void 0:p.client)?v:{},null!=(C=null==n||null==(b=n.overrides)?void 0:b.client)?C:{},{source:(null==n||null==(y=n.overrides)||null==(y=y.client)?void 0:y.source)||(null==f||null==(P=f.overrides)||null==(P=P.client)?void 0:P.source)||"react_sdk",version:(null==n||null==(S=n.overrides)||null==(S=S.client)?void 0:S.version)||(null==f||null==(k=f.overrides)||null==(k=k.client)?void 0:k.version)||"0.8.1"})}),onConnect:(null==n?void 0:n.onConnect)||(null==f?void 0:f.onConnect),onDisconnect:(null==n?void 0:n.onDisconnect)||(null==f?void 0:f.onDisconnect),onError:(null==n?void 0:n.onError)||(null==f?void 0:f.onError),onMessage:(null==n?void 0:n.onMessage)||(null==f?void 0:f.onMessage),onAudio:(null==n?void 0:n.onAudio)||(null==f?void 0:f.onAudio),onDebug:(null==n?void 0:n.onDebug)||(null==f?void 0:f.onDebug),onUnhandledClientToolCall:(null==n?void 0:n.onUnhandledClientToolCall)||(null==f?void 0:f.onUnhandledClientToolCall),onVadScore:(null==n?void 0:n.onVadScore)||(null==f?void 0:f.onVadScore),onInterruption:(null==n?void 0:n.onInterruption)||(null==f?void 0:f.onInterruption),onAgentToolResponse:(null==n?void 0:n.onAgentToolResponse)||(null==f?void 0:f.onAgentToolResponse),onConversationMetadata:(null==n?void 0:n.onConversationMetadata)||(null==f?void 0:f.onConversationMetadata),onMCPToolCall:(null==n?void 0:n.onMCPToolCall)||(null==f?void 0:f.onMCPToolCall),onMCPConnectionStatus:(null==n?void 0:n.onMCPConnectionStatus)||(null==f?void 0:f.onMCPConnectionStatus),onAsrInitiationMetadata:(null==n?void 0:n.onAsrInitiationMetadata)||(null==f?void 0:f.onAsrInitiationMetadata),onAgentChatResponsePart:(null==n?void 0:n.onAgentChatResponsePart)||(null==f?void 0:f.onAgentChatResponsePart),onModeChange:function(e){var o,r=e.mode;I(r),null==(o=(null==n?void 0:n.onModeChange)||(null==f?void 0:f.onModeChange))||o({mode:r})},onStatusChange:function(e){var o,r=e.status;m(r),null==(o=(null==n?void 0:n.onStatusChange)||(null==f?void 0:f.onStatusChange))||o({status:r})},onCanSendFeedbackChange:function(e){var o,r=e.canSendFeedback;M(r),null==(o=(null==n?void 0:n.onCanSendFeedbackChange)||(null==f?void 0:f.onCanSendFeedbackChange))||o({canSendFeedback:r})}})),Promise.resolve(h.current).then(function(n){return g.current=n,void 0!==w.current&&g.current.setMicMuted(w.current),void 0!==D.current&&g.current.setVolume({volume:D.current}),g.current.getId()}))}catch(n){return o(!0,n)}var a,s,v,p,C,b,y,P,S,k,A,O,F;return l&&l.then?l.then(o.bind(null,!1),o.bind(null,!0)):o(!1,l)}(0,function(n,e){if(h.current=null,n)throw e;return e})};if(null!=(e=g.current)&&e.isOpen())return Promise.resolve(g.current.getId());var a=function(){if(h.current)return Promise.resolve(h.current).then(function(n){var e=n.getId();return o=1,e})}();return Promise.resolve(a&&a.then?a.then(l):l(a))}catch(n){return Promise.reject(n)}},endSession:function(){try{var n=g.current;return g.current=null,Promise.resolve(null==n?void 0:n.endSession()).then(function(){})}catch(n){return Promise.reject(n)}},setVolume:function(n){var e;null==(e=g.current)||e.setVolume({volume:n.volume})},getInputByteFrequencyData:function(){var n;return null==(n=g.current)?void 0:n.getInputByteFrequencyData()},getOutputByteFrequencyData:function(){var n;return null==(n=g.current)?void 0:n.getOutputByteFrequencyData()},getInputVolume:function(){var n,e;return null!=(n=null==(e=g.current)?void 0:e.getInputVolume())?n:0},getOutputVolume:function(){var n,e;return null!=(n=null==(e=g.current)?void 0:e.getOutputVolume())?n:0},sendFeedback:function(n){var e;null==(e=g.current)||e.sendFeedback(n)},getId:function(){var n;return null==(n=g.current)?void 0:n.getId()},sendContextualUpdate:function(n){var e;null==(e=g.current)||e.sendContextualUpdate(n)},sendUserMessage:function(n){var e;null==(e=g.current)||e.sendUserMessage(n)},sendUserActivity:function(){var n;null==(n=g.current)||n.sendUserActivity()},sendMCPToolApprovalResult:function(n,e){var o;null==(o=g.current)||o.sendMCPToolApprovalResult(n,e)},changeInputDevice:function(n){try{var e,o=function(n){if(e)return n;throw new Error("Device switching is only available for voice conversations")},r=function(){if(g.current&&"changeInputDevice"in g.current)return Promise.resolve(g.current.changeInputDevice(n)).then(function(n){return e=1,n})}();return Promise.resolve(r&&r.then?r.then(o):o(r))}catch(n){return Promise.reject(n)}},changeOutputDevice:function(n){try{var e,o=function(n){if(e)return n;throw new Error("Device switching is only available for voice conversations")},r=function(){if(g.current&&"changeOutputDevice"in g.current)return Promise.resolve(g.current.changeOutputDevice(n)).then(function(n){return e=1,n})}();return Promise.resolve(r&&r.then?r.then(o):o(r))}catch(n){return Promise.reject(n)}},status:C,canSendFeedback:y,micMuted:s,isSpeaking:"speaking"===S}}export{c as getLivekitUrlForLocation,i as getOriginForLocation,u as parseLocation,a as useConversation};
//# sourceMappingURL=lib.module.js.map
