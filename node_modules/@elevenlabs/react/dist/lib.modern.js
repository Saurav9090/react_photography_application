import{useRef as n,useState as e,useEffect as l}from"react";import{Conversation as o}from"@elevenlabs/client";export{postOverallFeedback}from"@elevenlabs/client";function t(){return t=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var l=arguments[e];for(var o in l)({}).hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},t.apply(null,arguments)}const r=["micMuted","volume","serverLocation"];function u(n="us"){switch(n){case"eu-residency":case"in-residency":case"us":case"global":return n;default:return console.warn(`[ConversationalAI] Invalid server-location: ${n}. Defaulting to "us"`),"us"}}function i(n){return{us:"wss://api.elevenlabs.io","eu-residency":"wss://api.eu.residency.elevenlabs.io","in-residency":"wss://api.in.residency.elevenlabs.io",global:"wss://api.elevenlabs.io"}[n]}function a(n){return{us:"wss://livekit.rtc.elevenlabs.io","eu-residency":"wss://livekit.rtc.eu.residency.elevenlabs.io","in-residency":"wss://livekit.rtc.in.residency.elevenlabs.io",global:"wss://livekit.rtc.elevenlabs.io"}[n]}function s(s={}){const{micMuted:c,volume:d,serverLocation:v}=s,g=function(n,e){if(null==n)return{};var l={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(-1!==e.indexOf(o))continue;l[o]=n[o]}return l}(s,r),p=n(null),C=n(null),[y,b]=e("disconnected"),[h,M]=e(!1),[f,m]=e("listening"),w=n(c),S=n(d);return w.current=c,S.current=d,l(()=>{var n;void 0!==c&&(null==p||null==(n=p.current)||n.setMicMuted(c))},[c]),l(()=>{var n;void 0!==d&&(null==p||null==(n=p.current)||n.setVolume({volume:d}))},[d]),l(()=>()=>{var n;null==(n=p.current)||n.endSession()},[]),{startSession:async n=>{var e;if(null!=(e=p.current)&&e.isOpen())return p.current.getId();if(C.current)return(await C.current).getId();try{var l,r,s,c,d,y,h,f,I,D;const e=u((null==n?void 0:n.serverLocation)||v),k=i(e),A=a(e);return C.current=o.startSession(t({},null!=g?g:{},null!=n?n:{},{origin:k,livekitUrl:A,overrides:t({},null!=(l=null==g?void 0:g.overrides)?l:{},null!=(r=null==n?void 0:n.overrides)?r:{},{client:t({},null!=(s=null==g||null==(c=g.overrides)?void 0:c.client)?s:{},null!=(d=null==n||null==(y=n.overrides)?void 0:y.client)?d:{},{source:(null==n||null==(h=n.overrides)||null==(h=h.client)?void 0:h.source)||(null==g||null==(f=g.overrides)||null==(f=f.client)?void 0:f.source)||"react_sdk",version:(null==n||null==(I=n.overrides)||null==(I=I.client)?void 0:I.version)||(null==g||null==(D=g.overrides)||null==(D=D.client)?void 0:D.version)||"0.8.1"})}),onConnect:(null==n?void 0:n.onConnect)||(null==g?void 0:g.onConnect),onDisconnect:(null==n?void 0:n.onDisconnect)||(null==g?void 0:g.onDisconnect),onError:(null==n?void 0:n.onError)||(null==g?void 0:g.onError),onMessage:(null==n?void 0:n.onMessage)||(null==g?void 0:g.onMessage),onAudio:(null==n?void 0:n.onAudio)||(null==g?void 0:g.onAudio),onDebug:(null==n?void 0:n.onDebug)||(null==g?void 0:g.onDebug),onUnhandledClientToolCall:(null==n?void 0:n.onUnhandledClientToolCall)||(null==g?void 0:g.onUnhandledClientToolCall),onVadScore:(null==n?void 0:n.onVadScore)||(null==g?void 0:g.onVadScore),onInterruption:(null==n?void 0:n.onInterruption)||(null==g?void 0:g.onInterruption),onAgentToolResponse:(null==n?void 0:n.onAgentToolResponse)||(null==g?void 0:g.onAgentToolResponse),onConversationMetadata:(null==n?void 0:n.onConversationMetadata)||(null==g?void 0:g.onConversationMetadata),onMCPToolCall:(null==n?void 0:n.onMCPToolCall)||(null==g?void 0:g.onMCPToolCall),onMCPConnectionStatus:(null==n?void 0:n.onMCPConnectionStatus)||(null==g?void 0:g.onMCPConnectionStatus),onAsrInitiationMetadata:(null==n?void 0:n.onAsrInitiationMetadata)||(null==g?void 0:g.onAsrInitiationMetadata),onAgentChatResponsePart:(null==n?void 0:n.onAgentChatResponsePart)||(null==g?void 0:g.onAgentChatResponsePart),onModeChange:({mode:e})=>{var l;m(e),null==(l=(null==n?void 0:n.onModeChange)||(null==g?void 0:g.onModeChange))||l({mode:e})},onStatusChange:({status:e})=>{var l;b(e),null==(l=(null==n?void 0:n.onStatusChange)||(null==g?void 0:g.onStatusChange))||l({status:e})},onCanSendFeedbackChange:({canSendFeedback:e})=>{var l;M(e),null==(l=(null==n?void 0:n.onCanSendFeedbackChange)||(null==g?void 0:g.onCanSendFeedbackChange))||l({canSendFeedback:e})}})),p.current=await C.current,void 0!==w.current&&p.current.setMicMuted(w.current),void 0!==S.current&&p.current.setVolume({volume:S.current}),p.current.getId()}finally{C.current=null}},endSession:async()=>{const n=p.current;p.current=null,await(null==n?void 0:n.endSession())},setVolume:({volume:n})=>{var e;null==(e=p.current)||e.setVolume({volume:n})},getInputByteFrequencyData:()=>{var n;return null==(n=p.current)?void 0:n.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var n;return null==(n=p.current)?void 0:n.getOutputByteFrequencyData()},getInputVolume:()=>{var n,e;return null!=(n=null==(e=p.current)?void 0:e.getInputVolume())?n:0},getOutputVolume:()=>{var n,e;return null!=(n=null==(e=p.current)?void 0:e.getOutputVolume())?n:0},sendFeedback:n=>{var e;null==(e=p.current)||e.sendFeedback(n)},getId:()=>{var n;return null==(n=p.current)?void 0:n.getId()},sendContextualUpdate:n=>{var e;null==(e=p.current)||e.sendContextualUpdate(n)},sendUserMessage:n=>{var e;null==(e=p.current)||e.sendUserMessage(n)},sendUserActivity:()=>{var n;null==(n=p.current)||n.sendUserActivity()},sendMCPToolApprovalResult:(n,e)=>{var l;null==(l=p.current)||l.sendMCPToolApprovalResult(n,e)},changeInputDevice:async n=>{if(p.current&&"changeInputDevice"in p.current)return await p.current.changeInputDevice(n);throw new Error("Device switching is only available for voice conversations")},changeOutputDevice:async n=>{if(p.current&&"changeOutputDevice"in p.current)return await p.current.changeOutputDevice(n);throw new Error("Device switching is only available for voice conversations")},status:y,canSendFeedback:h,micMuted:c,isSpeaking:"speaking"===f}}export{a as getLivekitUrlForLocation,i as getOriginForLocation,u as parseLocation,s as useConversation};
//# sourceMappingURL=lib.modern.js.map
